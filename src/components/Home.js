import React from 'react';
import { connect } from 'react-redux'
import '../css/home.css'
import axios from 'axios'
import Position from './position'
import { Link } from 'react-router-dom'
class Home extends React.Component{
  componentWillMount(){
    this.props.dispatch({type:'CHANGEHEADERVSL',headerval:'首页'})
    axios.get('http://petapi.haoduoshipin.com/shops')
      .then(res => this.props.dispatch({type:'ALLSHOP',shop:res.data.shops}))
  }
  render(){
    return (
      <div>
        <div className='home-header'>
          <div><Position/></div>
          <div><Link to="search"><svg viewBox="0 0 1024 1024"><path fill="#707070" d="M955.894368 904.307967l-129.891326-107.72242c26.882254-33.67803 48.734958-71.095221 65.138556-111.682615 22.150486-54.806233 33.381271-112.992447 33.381271-172.944887 0-59.95244-11.231809-118.139677-33.381271-172.944887-21.423939-53.007261-52.107775-100.627838-91.201142-141.53962-39.187511-41.010019-84.857667-73.223698-135.743614-95.747691-52.798507-23.370267-108.87978-35.220153-166.69044-35.220153s-113.892957 11.849886-166.692486 35.220153c-50.885947 22.523993-96.557126 54.738695-135.743614 95.747691-39.09439 40.911782-69.778226 88.532359-91.203188 141.53962-22.150486 54.80521-33.381271 112.992447-33.381271 172.944887 0 59.95244 11.231809 118.140701 33.381271 172.944887 21.424962 53.007261 52.108798 100.626815 91.203188 141.538597 39.186488 41.008996 84.85869 73.223698 135.743614 95.746668 52.79953 23.370267 108.881826 35.220153 166.692486 35.220153s113.891933-11.849886 166.69044-35.220153c44.316322-19.615757 84.672448-46.587038 120.239502-80.311117l132.264373 109.689215c5.730515 4.753257 12.674671 7.070023 19.579941 7.070023 8.820899 0 17.576307-3.78214 23.64656-11.103896C970.75175 934.484244 968.945615 915.130454 955.894368 904.307967zM497.507426 896.011001c-201.604624 0-365.622188-172.284855-365.622188-384.052956s164.017564-384.053979 365.622188-384.053979c201.602577 0 365.618095 172.285878 365.618095 384.053979S699.110003 896.011001 497.507426 896.011001z" /></svg>请输入商家、商品名</Link></div>
        </div>
        <div>
          <p style={{lineHeight:'0.3rem',paddingLeft:'0.2rem'}}>商家</p>
          <ul className="shopList">
            {
              this.props.allshop.length ? this.props.allshop.map(item => {
                return (
                  <li key={item._id} style={{background:'#fff',marginBottom:'0.08rem'}}>
                    <Link to={{ pathname: `/commodity/${item._id}`, title: item.name }}>
                      <div><img src={item.poster ? item.poster : "https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=3011329581,2931078622&fm=117&gp=0.jpg"} alt="img"/></div>
                      <p>{item.name}</p>
                      <svg viewBox="0 0 1024 1024"><path fill="#707070" d="M679.374008 511.753383 280.140305 112.531959c-11.102872-11.090593-11.102872-29.109991 0-40.177048 11.090593-11.109012 29.092595-11.109012 40.188304 0l414.455383 414.450267c2.229784 1.246387 4.973268 0.947582 6.874571 2.843768 6.076392 6.076392 8.508791 14.167674 7.936763 22.103414 0.572028 7.941879-1.860371 16.034185-7.936763 22.097274-1.902326 1.908466-4.650927 1.603521-6.886851 2.856048L320.329633 951.169251c-11.096732 11.084453-29.097712 11.084453-40.188304 0-11.102872-11.114129-11.102872-29.091572 0-40.200584L679.374008 511.753383z" /></svg>
                    </Link>
                  </li>
                )
              }) : null
            }
          </ul>
        </div>
      </div>
    )
  }
}
const mapStateToProps = (state) => ({
  allshop:state.allshop
})
export default connect(mapStateToProps)(Home)
